---
title: "Rethinking Traditional Values: Analyzing How Messages of Climate Change Affect Family Planning Among Millennials and Generation Z"
author: "Laura Gattis, Emmanuel Maduneme, Megan Denneny, Sam Lorenzo"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true 
    toc_collapsed: true
    toc_depth: 4
    number_sections: false
bibliography: data_script_references.bib
csl: apa.csl

---

# Abstract\centering

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      eval = TRUE,
                      message = FALSE)
library(tidyverse)
library(psych)
library(skimr)
library(readr)
library(janitor)
library(rio)
library(here)
library(ggthemes)
library(readxl)
library(DT)

```




# Introduction\centering

Climate change continues to be perceived as a significant risk among Americans, especially among younger demographics. Millennials, in particular, those born between 1981 and 1996, were found to be the group most adamant about prioritizing the issue of climate change, with 71 percent of Millennials indicating climate change to be the most important issue to address in order to protect and sustain the planet for future generations (Funk). According to a 2020 poll by Morning Consult, one-in-four adults under the age of 45 indicated that climate change plays a role (either major or minor) in their decision to not have children (Jenkins). A prior survey also measured the various reasons why young adults are choosing to have fewer than their ideal number of children, with 37 percent of respondents expressing a concern about global instability and 33 percent specifying the burden of climate change as key motives (Miller). 

We hypothesize that the way in which media messages about climate change are framed and interpreted negatively impacts Millennial and Generation Z perceptions about having children.

## Specific Aims/Study Objectives\centering
This analysis intends to answer the following research question: What effect do messages about climate change have on Millennials and Generation Z and their desire to have children?




# Methods, Materials, and Analysis\centering
We used `R programming` [@R] for analysis with the following packages: `janitor` [@janitor], `psych` [@psych], `skimr` [@skimr], `here` [@here], `knitr` [@knitr], `rio` [@rio], `readxl` [@readxl], `DT` [@DT] and `tidyverse` [@tidyverse]. 


After loading our data set **css_ghana**, we proceeded to use different functions like `filter()`, `mutate()`, `pivot_longer`, `pivot_wider`, `group_by`, and `select()` to tidy the data.



Researchers implemented a two-step, mixed-method approach to assess Millennial and Generation Z perceptions on family planning and to what extent (if any) climate change influences these views. For the purposes of this class, we will be analyzing the survey data we collected. The survey consisted of an online Likert-type questionnaire that was distributed to Ghanaian Millennials (those born between 1981 and 1996) and Generation Z adults (18 years old or older; those born between 1997 and 2004). The current sample size is made up of answers from 130 respondents. Through this survey, participants were asked questions about their personal stances on having children, perceptions of climate change, how much of an impact climate change has on their family planning, and their feelings towards the effectiveness of climate change messages. A scale from zero to five was provided for respondents to record their answers, with zero indicating no impact and five stipulating high impact. 

## Data Preparation Script Plan:

We are utilizing the data collected to quantitatively determine if there are any correlations between views amongst demographics and to see if responses tend to skew towards specific perceptions (e.g., high fear of climate change, low desire to have children). Our plan is to use our data to better visualize participant responses and categorize information into a variety of sets. We are employing a randomizer tool to skew the responses we received. 


These are some descriptive information about the data. 



```{r tidying data, include=FALSE}
css_ghana <- read_excel(here("Data", "Climate_Synthetic.xlsx"))



css_ghana <- css_ghana %>% 
  pivot_longer(c("Male", "Female"), 
               names_to = "Gender",
               values_to = "value") %>% 
  select(-(starts_with("1.")), -value,1:2,Gender, everything()) %>% 
  filter(Status == "Completed") %>% 
  rename(q8_cc_priority = "8. How should addressing issues of climate change be prioritized?") %>% 
  filter(!is.na(q8_cc_priority)) %>% 
  rename(age_generation =  "Which age generation below applies to you",
    q_10_cc_message_effec_providing_info  = 
      "10. Think about messages you’ve seen in the media about climate change. How effective were they in terms of providing information?",
    q_17_cc_infuence_child_desire = 
      "17. How much of an influence has climate change had on your desire to have children?",
    q7_cc_concerned = "7. How concerned are you about climate change?") %>% 
  mutate(age_gen_recoded = 
           case_when(age_generation ==  "Other" ~ "Others",
                     age_generation == "1997-2004" ~ "Gen_Z",
                     TRUE ~ "Millennials")) %>% 
   select(1:3, age_gen_recoded, everything())
 
names(css_ghana)[8] = "q_16_not_parent_chid_desire"
css_ghana <- css_ghana %>% 
  filter(!is.na(q_10_cc_message_effec_providing_info),
         !is.na( q_17_cc_infuence_child_desire),
         !is.na(q_16_not_parent_chid_desire),
         !is.na(q8_cc_priority))

css_ghana$Gender <- as.factor(css_ghana$Gender)

css_ghana$age_gen_recoded <- as.factor(css_ghana$age_gen_recoded)

 css_ghana$q7_cc_concerned <- recode(css_ghana$q7_cc_concerned, "Not at all" = 1, "Not very concerned" = 2 , "Slightly concerned" = 3, "Moderately concerned" = 4, "Very concerned" = 5,     
         "Extremely concerned" = 6)
  

## the row names were not properly written so I had to recode it  
css_ghana <- css_ghana %>% 
  mutate(q8_cc_priority = case_when(
    q8_cc_priority == "Low priority" ~"1",
    q8_cc_priority == "Moderate priority" ~ "3",
    q8_cc_priority == "Major priority" ~ "4",
    q8_cc_priority == "Top priority" ~ "5",
    q8_cc_priority == "Minor priority" ~ "2",
    q8_cc_priority == " Minor priority" ~ "2",
  ))

css_ghana$q_16_not_parent_chid_desire <- recode(css_ghana$q_16_not_parent_chid_desire,
  "Extremely high desire" = 7, "High desire" = 6,  "Minor desire" = 5, 
  "Moderate desire" = 4, "No desire or unsure" = 3,  "Somewhat dissatisfied" = 2,
  "Very low desire" = 1)  

css_ghana$q_17_cc_infuence_child_desire <- recode(css_ghana$q_17_cc_infuence_child_desire,
"Barely any influence" = 6, "Major influence" = 5,  "Minor influence" = 4,     "Moderate influence" = 3,
 "No influence at all" = 2, "Top influence"  = 1)


css_ghana$q_10_cc_message_effec_providing_info <- recode(css_ghana$q_10_cc_message_effec_providing_info,
"Extremely effective" = 6,               "Moderately effective"  = 5,                 
 "Not effective at all or Not applicable" = 4, "Slightly effective"  = 3,                 
 "Very effective" = 2 ,                    "Very low effect" = 1)


```



```{r}



## Pivot Wider for Assignment
css_ghana %>% 
  pivot_wider(
    names_from = age_gen_recoded,
    values_from = age_generation
  ) %>%
  pivot_longer(
    cols = c(Millennials, Gen_Z),
    names_to = "age_generation_pivot",
    values_to = "age_brackets"
  ) %>% 
  select(-starts_with("1.")) %>% 
  select(Gender, age_generation_pivot, everything(), -q_16_not_parent_chid_desire, -value, -Others,-age_brackets, -ID, -Status) %>% 
  datatable(class = 'cell-border stripe',
            colnames = c('Gender', 'Age Generation', 'Climate Change Concern', 'Climate Change Priority',
                         'Media Climate Change Message Efficacy', "Desire For Children"))
 
  

  
```


```{r Descriptives}
## Changed wording of title and legend slightly

css_ghana %>% 
  ggplot(aes(q8_cc_priority))+
  geom_bar(aes(fill = age_gen_recoded), position = "dodge") +
  theme_minimal() +
  labs(x = "Climate Change Should Be Prioritized (1 = Low, 5 = High)",
         y = "Frequency",
         title = "Climate Change Prioritization By Generation",
       subtitle = "(Data obtained from a survey in Ghana, West Africa)") +
  guides(fill=guide_legend(title= "Generation"))


```


```{r}
 ## Changing wording of title, subtitle, legend and x-axis slightly.

css_ghana %>% 
  mutate(q8_cc_priority = as.numeric(q8_cc_priority)) %>% 
 group_by(age_gen_recoded) %>% 
  summarize(mean_priority = mean(q8_cc_priority, na.rm = TRUE),
            mean_concerned = mean(q7_cc_concerned, na.rm = TRUE),
            mean_desire_for_child = mean(q_17_cc_infuence_child_desire, na.rm = TRUE)) %>% 
   ggplot(aes(age_gen_recoded, mean_desire_for_child, fill = age_gen_recoded)) +
  geom_col() +
  guides(fill=guide_legend(title= "Generation"))+
  theme_minimal() +
   labs(x = "Generation",
         y = "Average Influence of Climate Change on Desire to Have Children",
         title = "Climate Change Influence on Desire to Have Children",
         subtitle = "(Data obtained from a survey in Ghana, West Africa)") +
  scale_fill_manual(values = c("grey0",
                              "goldenrod", 
                              "goldenrod4")) +
    coord_flip()
   


```


```{r}

## Changing wording of title and y-axis slightly.

css_ghana %>% 
  group_by(age_gen_recoded) %>% 
  summarise(mean_message = mean(q_10_cc_message_effec_providing_info, na.rm = TRUE),
            avrg_desire = mean(q_17_cc_infuence_child_desire)) %>% 
  ggplot(aes(mean_message, avrg_desire)) + 
  geom_point(aes(col = age_gen_recoded), size = 5)+
  geom_smooth() +
   guides(fill=guide_legend(title= "Generation")) +
    labs(x = "Climate Change Media Effectiveness",
         y = "Average Influence of Climate Change on Desire to Have Children",
         title = "Climate Change Messaging on Desire to Have Children",
         subtitle = "(Data obtained from a survey in Ghana, West Africa)") 
   
  
```


# Findings and Results\centering


```{r findings}

## Added in two more variables and visual (below) that are a bit more comprehensive. 

research_questions <- css_ghana %>% 
  select(age_gen_recoded, q7_cc_concerned, q8_cc_priority, q_10_cc_message_effec_providing_info, q_17_cc_infuence_child_desire) %>% 
  rename(
    "How concerned are you about climate change?" = q7_cc_concerned,
    "How should addressing issues of climate change be prioritized?" = q8_cc_priority,
    "How effective is climate change news in terms of providing information?" = q_10_cc_message_effec_providing_info,
    "How much of an influence has climate change had on your desire to have children?" = q_17_cc_infuence_child_desire
    ) %>% 
  view()



```


```{r results}

research_questions %>% 
  pivot_longer(
    cols = -age_gen_recoded,
    names_to = "r_questions",
    values_to = "each_score",
    values_transform = list(each_score = as.integer)
  ) %>% 
  group_by(r_questions, age_gen_recoded) %>% 
  summarize(avrg_score = mean(each_score, na.rm = TRUE)) %>% 
 mutate(research_questions = factor(r_questions, level = c("How concerned are you about climate change?", "How should addressing issues of climate change be prioritized?", "How effective is climate change news in terms of providing information?", "How much of an influence has climate change had on your desire to have children?"))) %>% 
  ggplot(aes(x = age_gen_recoded, y = avrg_score, fill = age_gen_recoded)) + 
      geom_col(position = "dodge") + 
      facet_wrap(~research_questions, 
                 ncol = 1,
                 nrow = 6) + 
      theme_minimal()  + 
      scale_fill_colorblind() + 
      labs(
        title = "Climate Change and Family Planning Perceptions", 
        subtitle = "By Generation", 
        x = "Generation", 
        y = "Level of Perception",
        fill = "Generation", 
        caption = "(Data obtained from a survey in Ghana, West Africa)"
        )+
  coord_flip()

```
```{r}
agg_data %>% 
 summarise(research_questions = mean(research_questions, na.rm = TRUE), 
           final_responses = mean(final_responses, na.rm = TRUE)) %>% 
  mutate(
    research_questions = c("How concerned are you about climate change?", "How should addressing issues of climate change be prioritized?", "Think about messages you’ve seen in the media about climate change. How effective were they in terms of providing information?", "How much of an influence has climate change had on your desire to have children?"),
    final_responses = factor(final_responses, level = c(1, 2, 3, 4, 5))
    ) %>% 
  ggplot(aes(x = NROW(css_ghana), y = final_responses, fill = age_gen_recoded)) + 
  geom_col(position = "dodge") + 
  facet_wrap(~research_questions, 
                  ncol = 1,
                  nrow = 6) + 
       theme_minimal()  + 
       scale_fill_colorblind() + 
       labs(
         title = "Climate Change and Family Planning Perceptions", 
         subtitle = "by Generation", 
         x = "Number of Responses", 
         y = "Level of Perception",
         fill = "Generation", 
         caption = "(Data obtained from a survey in Ghana, West Africa)"
         )
```

# Discussion\centering

\newpage
# References\centering
